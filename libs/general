#!/bin/bash
#----------------------------------------------------------------------------------
#
#   Проект: Молот [molot]
# 
#   Эта общая библиотека функций, которая используется 
# 	в различных местах пакета
# 
#   Автор       : Железа
#   Email       : dev@zeleza.ru
#   Лицензия    : Apache Версия 2.0
#
#   Создан      : 27 октября 2024 год
#   Обновлен    : 30 октября 2024 год
# 
#----------------------------------------------------------------------------------

LENGTH=80                    # длина строки в символах 
YELLOW="\e[33m"              # желтый цвет текста
BLUE="\e[36m"                # синий цвет текста
RED="\e[01;31m"              # красный цвет текста
BOLD="\e[1m"          		 # жирный цвет текста
GREEN="\e[32m"               # темно зеленый цвет текста
NOCL="\e[m"                  # возвращает текст к настройкам по умолчанию.


pause(){
	# просто выводим сообщение и ждем нажатия любой клавиши 
	[ -n "$1" ] && {
		echo -e "${GREEN}${BOLD}${1}${NOCL}"
		print_line
	}
	read -r pause &> /dev/null
}


print_line() {
	# функция печатает заданное число раз один и тот же символ
	len=$((LENGTH))
	printf "%${len}s\n" | tr " " "-"
}

message() {
	# Выводит простое сообщение
	echo -e "${1}"
}

header() {
	# Выводит заголовок
	# print_line
	echo -e "${GREEN}${BOLD}${1}${NOCL}"
	print_line
}

allright() {
	# Выводит если все хорошо
	echo -e "${GREEN}${BOLD}${1}${NOCL}"
}

error() {
	# Выводит сообщение об ошибке
    print_line
    echo -e "${RED}${BOLD}${1}${NOCL}"
    print_line
}

warning() {
	# Выводит предупреждение
	echo -e "${YELLOW}${BOLD}${1}${NOCL}"
}

is_host_available() {
	# Проверяем доступность хоста
    local _host="${1//root@/}"
    ping -c 2 -W 2 "${_host// /}"  &>/dev/null
}


read_ynq() {
# ------------------------------------------------------------------------------------------
#
#	 Читаем Y/N/Q из ввода данных в цикле
# 	 $1 - заголовок для запроса
# 	 $2 - переменная в которой возвращается результат
#
# ------------------------------------------------------------------------------------------
	header="$(echo "${1}" | tr -d '?')"; quest="[Y/N/Q]?"
#	в случае, если встретиться слово с корнем "удал", то цвет заголовка - красный
	if echo "${header}" | grep -qiE "удал"; then
		header="${YELLOW}${header} ${quest}${NOCL}";
	else
		if echo "${header}" | grep -qiE "[Y]"; then
			header="${BLUE}${header}${NOCL}";
		else
			header="${BLUE}${header} ${quest}${NOCL}";
		fi
	fi
	while true; do
		echo -en "${header}  "
		read -r ynq
		case "${ynq}" in
			[YyNnQq]* ) eval "${2}=${ynq^^}"; break; 
			;;
			*) echo -e "Пожалуйста ответьте на вопрос ${GREEN}'Y' - да${NOCL} или ${RED}'N' - нет${NOCL}, ${BLUE}Q - выход${NOCL}" 
			;;
		esac
	done
}
